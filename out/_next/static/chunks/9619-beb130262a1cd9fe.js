"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9619],{39619:function(e,t,n){n.r(t);var a=n(34051),r=n.n(a),o=n(85893),l=n(48940),s=n(45161),c=n(18618),i=n(35541),u=n(19778),d=n(14581),x=n(54346),f=n(93717),p=n(71293),m=n(4480),k=n(54968),b=n(37243),h=n(25675),S=n.n(h),y=n(79822),_=n(79859),g=n(60483),O=n(67294),w=n(26882),v=n(68462),j=n(81271),T=n(79102),Z=n(29619),L=n(28450),C=n(43382),A=n(50482),D=n(60938),E=n(94359),M=n(74506),V=n(60316),N=n(57683),P=n(45379),I=n(36192),K=n(17767),B=n(88586),z=n(27541),W=n(72005),R=n(45093),U=n(34824),F=n(27520);function H(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function G(e,t,n,a,r,o,l){try{var s=e[o](l),c=s.value}catch(i){return void n(i)}s.done?t(c):Promise.resolve(c).then(a,r)}function Y(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function l(e){G(o,a,r,l,s,"next",e)}function s(e){G(o,a,r,l,s,"throw",e)}l(void 0)}))}}function $(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function q(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o=[],l=!0,s=!1;try{for(n=n.call(e);!(l=(a=n.next()).done)&&(o.push(a.value),!t||o.length!==t);l=!0);}catch(c){s=!0,r=c}finally{try{l||null==n.return||n.return()}finally{if(s)throw r}}return o}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return H(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return H(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}t.default=function(){(0,l.F)();var e=(0,s.If)().colorMode,t=(0,b.Z)(),n=t.selectedModalData,a=t.selectedModal,h=t.closeModal,H=t.isModalLoading,G=t.modalSectionMtValue,J=((0,j.Z)().bondModalData,(0,D.Z)("Stake_screen","stake_modal")),Q=J.inputValue,X=J.setValue,ee=J.setResetValue,te=(0,E.Z)(),ne=te.ltos,ae=te.currentBalance,re=te.newBalance,oe=te.currentTosValue,le=te.newBalanceTosValue,se=(0,v.Z)(),ce=se.StakingV2Proxy_CONTRACT,ie=se.TOS_CONTRACT,ue=L.Z.StakingV2Proxy,de=(0,Z.Z)().userTOSBalance,xe=(0,C.Z)(),fe=(xe.stakeList,xe.tosAllowance),pe=(0,O.useState)(!1),me=pe[0],ke=pe[1],be=(0,O.useState)(!1),he=be[0],Se=be[1],ye=(0,O.useState)(!1),_e=ye[0],ge=ye[1],Oe=q((0,c.a)("(max-width: 1024px)"),1)[0],we=(0,F.Z)().bp700px,ve=(0,M.Z)(Number(Q.stake_modal_balance),Q.stake_modal_period),je=ve.newEndTime,Te=ve.leftDays,Ze=(ve.leftWeeks,ve.leftHourAndMin),Le=(0,W.Z)().newBalanceStos,Ce=(0,I.Z)().ltosIndex,Ae=(0,P.Z)(":"),De=q((0,m.FV)(k.ws),2),Ee=De[0],Me=De[1],Ve=q((0,m.FV)(k.lW),2),Ne=Ve[0],Pe=Ve[1],Ie=(0,N.Z)().setTx,Ke=(0,K.Z)(),Be=Ke.inputOver,ze=Ke.inputPeriodOver,We=Ke.btnDisabled,Re=Ke.zeroInputBalance,Ue=B.Z.errMsg,Fe=B.Z.modalMaxWeeks,He=(me?("".concat(Q.stake_modal_balance||"-"," TOS"),Ee||"".concat(ne," LTOS"),"".concat(Q.stake_modal_balance," TOS. As LTOS index increases, the number of TOS you can get from unstaking LTOS will also increase."),"".concat(ae||"-"," LTOS"),"".concat(oe," TOS. As LTOS index increases, the number of TOS you can get from unstaking LTOS will also increase."),"".concat(re||"-"," LTOS"),"".concat(le," TOS. As LTOS index increases, the number of TOS you can get from unstaking LTOS will also increase.")):("".concat(Q.stake_modal_balance||"-"," TOS"),Ne||(0,R.Z)(Le),"".concat((0,R.Z)(Q.stake_modal_balance)," TOS. As LTOS index increases, the number of TOS you can get from unstaking LTOS will also increase."),"".concat(je||"-")),(0,O.useCallback)((function(){ee(),ke(!1),h()}),[ee,h])),Ge=(0,O.useCallback)(Y(r().mark((function e(){var t,n,a;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!ce){e.next=17;break}if(!me){e.next=9;break}return console.log("---stake()---"),console.log(Q.stake_modal_balance),e.next=6,ce.stake((0,T.Az)(Q.stake_modal_balance));case 6:return t=e.sent,Ie(t),e.abrupt("return",He());case 9:return n=Q.stake_modal_period+1,console.log("---stakeGetStos()---"),console.log((0,T.Az)(Q.stake_modal_balance),n),e.next=14,ce.stakeGetStos((0,T.Az)(Q.stake_modal_balance),n);case 14:return a=e.sent,Ie(a),e.abrupt("return",He());case 17:case"end":return e.stop()}}),e)}))),[Q.stake_modal_balance,Q.stake_modal_period,ce,me,He,Ie]),Ye=(0,O.useCallback)(Y(r().mark((function e(){var t,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!ie){e.next=14;break}return ge(!0),e.next=5,ie.totalSupply();case 5:return t=e.sent,e.next=8,ie.approve(ue,t);case 8:if(n=e.sent,Ie(n),!n){e.next=14;break}return e.next=13,n.wait();case 13:ge(!1);case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(0),ge(!1);case 19:case"end":return e.stop()}}),e,null,[[0,16]])}))),[ie,ue,Ie]);return(0,O.useEffect)((function(){var e;if(fe)return 0===fe?Se(!1):(null===(e=Q.stake_modal_balance)||void 0===e?void 0:e.length)<=0||void 0===Q.stake_modal_balance||fe>=Number(Q.stake_modal_balance)?Se(!0):Se(!1)}),[fe,Q.stake_modal_balance,he]),(0,O.useEffect)((function(){return"LTOS Staking"===(null===n||void 0===n?void 0:n.stakedType)?ke(!0):ke(!1)}),[n]),(0,O.useEffect)((function(){de&&X(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),a.forEach((function(t){$(e,t,n[t])}))}return e}({},Q,{stake_modal_balance:String(de.replaceAll(",",""))}))}),[de,X,a]),(0,O.useEffect)((function(){Pe(!0)}),[Q,Pe]),(0,O.useEffect)((function(){Me(!0)}),[Q.stake_modal_balance,Me]),(0,o.jsxs)(i.u_,{isOpen:"stake_stake_modal"===a,isCentered:!0,onClose:He,children:[(0,o.jsx)(u.Z,{className:"modalOverlayDrawer",bg:"none"}),(0,o.jsx)(d.h,{bg:"light"===e?"white.100":"#121318",minW:we?"350px":"700px",maxW:we?"350px":"700px",mt:G,children:(0,o.jsx)(x.f,{px:0,pt:"30px",children:(0,o.jsxs)(f.k,{w:"100%",flexDir:"column",children:[(0,o.jsxs)(f.k,{flexDir:"column",pos:"relative",children:[(0,o.jsxs)(f.k,{w:"100%",justifyContent:"center",mb:"33px",h:"28px",children:[(0,o.jsx)(p.x,{color:"light"===e?"gray.800":"white.200",fontSize:20,fontWeight:600,children:"Stake"}),(0,o.jsx)(f.k,{pos:"absolute",right:"1.56em",cursor:"pointer",onClick:function(){return He()},children:(0,o.jsx)(S(),{src:y.default,alt:"CLOSE_ICON"})})]}),(0,o.jsxs)(f.k,{w:"100%",px:we?"20px":"120px",flexDir:"column",mb:"29px",children:[(0,o.jsxs)(f.k,{w:"100%",justifyContent:we?"center":"space-between",mb:we?"15px":"9px",flexDir:we?"column":"row",alignItems:"center",children:[(0,o.jsx)(A.default,{title:"Next Rebase",content:Ae,tooltip:"Time left until LTOS index is increased."}),(0,o.jsx)(A.default,{title:"LTOS Index",content:Ce,symbol:"TOS",tooltip:"Number of TOS you get when you unstake 1 LTOS. LTOS index increases every 8 hours."})]}),(0,o.jsx)(f.k,{mb:"9px",w:"100%",children:(0,o.jsx)(w.v,{w:"100%",h:45,placeHolder:"Enter an amount of TOS",pageKey:"Stake_screen",recoilKey:"stake_modal",atomKey:"stake_modal_balance",maxValue:Number(null===de||void 0===de?void 0:de.replaceAll(",","")),isError:Re||Be,errorMsg:Re?Ue.bondZeroInput:Ue.balanceExceed,rightUnit:"TOS"})}),(0,o.jsxs)(f.k,{fontSize:12,color:"dark"===e?"#8b8b93":"gray.1000",h:"17px",justifyContent:"space-between",mb:we?"22px":"12px",px:"6px",children:[(0,o.jsx)(p.x,{children:"Your Balance"}),(0,o.jsxs)(p.x,{children:[de||"-"," TOS"]})]}),(0,o.jsx)(f.k,{flexDir:"column",children:(0,o.jsxs)(f.k,{flexDir:we?"column":"row",fontSize:12,alignItems:"center",children:[(0,o.jsxs)(f.k,{justifyContent:"space-between",w:we?"100%":"",mb:we?"10px":"",children:[(0,o.jsx)(p.x,{mr:"24px",color:"light"===e?"gray.800":"white.200",children:"Lock-Up Period"}),(0,o.jsxs)(f.k,{alignSelf:"flex-end",children:[(0,o.jsx)(_.Z,{pageKey:"Bond_screen",value:"",valueKey:"Bond_Modal",state:me,setState:ke}),(0,o.jsx)(p.x,{ml:"9px",children:"No Lock-Up"})]})]}),(0,o.jsx)(z.Z,{w:we?"310px":"220px",h:"39px",pageKey:"Stake_screen",recoilKey:"stake_modal",atomKey:"stake_modal_period",placeHolder:"1 Weeks",style:{marginLeft:"auto"},isDisabled:me,maxValue:Fe,isError:ze,errorMsg:Ue.stakePeriodExceed,leftDays:me?void 0:Te,leftTime:me?void 0:Ze,endTime:me||ze||Be||Re?void 0:je})]})})]}),(0,o.jsx)(f.k,{px:we?"30px":"43px",mb:"30px",children:(0,o.jsx)(V.default,{pageKey:"Stake_screen",subKey:"stake_modal",periodKey:"stake_modal_period",isSlideDisabled:me,minValue:0})}),(0,o.jsx)(U.default,{fiveDaysLockup:me})]}),(0,o.jsx)(f.k,{justifyContent:"center",mb:"21px",children:he?(0,o.jsx)(g.Z,{w:Oe?310:460,h:42,name:"Stake",onClick:Ge,isDisabled:(me?Re||Be:We)||H}):(0,o.jsx)(g.Z,{w:Oe?310:460,h:42,name:"Approve",onClick:Ye,isDisabled:Re||Be||H,isLoading:_e})}),!he&&(0,o.jsx)(f.k,{fontSize:11,color:"#64646f",textAlign:"center",w:"100%",mb:"24px",children:(0,o.jsx)(p.x,{w:"100%",color:"dark"===e?"gray.200":"gray.700",children:"Please approve your TOS to use this service"})})]})})})]})}}}]);