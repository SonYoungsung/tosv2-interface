"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6100],{96100:function(e,t,n){n.r(t),n.d(t,{default:function(){return $}});var o=n(34051),r=n.n(o),a=n(85893),l=n(48940),i=n(45161),u=n(35541),c=n(19778),s=n(14581),d=n(54346),p=n(93717),f=n(71293),m=n(4480),x=n(54968),b=n(37243),h=n(25675),v=n.n(h),k=n(79822),_=n(60483),y=n(67294),S=n(26882),g=n(68462),T=n(81271),w=n(79102),O=n(29619),j=n(46850),M=n(28450),C=n(43382),E=n(89406),A=n(60938),N=n(5371),Z=n(60316),I=n(83671),L=n(37007),D=n(95787),P=n(57683),V=n(88586);var z=function(e){var t=(0,y.useState)(!0),n=t[0],o=t[1],r=(0,y.useState)(!0),a=r[0],l=r[1],i=(0,y.useState)(!0),u=i[0],c=i[1],s=(0,y.useState)(!1),d=s[0],p=s[1],f=(0,y.useState)(!1),m=(f[0],f[1],(0,y.useState)(!1)),x=m[0],h=m[1],v=(0,O.Z)().userTOSBalance,k=(0,b.Z)().isModalLoading,_=(0,A.Z)("Stake_screen","update_modal").inputValue,S=_.stake_updateModal_tos_balance,g=_.stake_updateModal_period,T=V.Z.modalMaxWeeks;return(0,y.useEffect)((function(){return k?p(!1):void 0===S||0===S.length||Number(S)<=0?(p(!0),o(!1)):v&&S?Number(S)>Number(v.replaceAll(",",""))?(p(!1),o(!0)):(p(!1),o(!1)):void 0}),[S,v,k]),(0,y.useEffect)((function(){return T<Number(g)||Number(g)<e||Number(g)<0||0===(null===g||void 0===g?void 0:g.length)?l(!0):l(!1)}),[g,e,T]),(0,y.useEffect)((function(){return n||a||void 0===S||0===(null===S||void 0===S?void 0:S.length)||0===Number(S)&&g-e===0?c(!0):c(!1)}),[n,a,S,g,e]),(0,y.useEffect)((function(){void 0!==S&&0!==(null===S||void 0===S?void 0:S.length)&&0!==Number(S)||g-e!==0&&0!==(null===g||void 0===g?void 0:g.length)?h(!1):h(!0)}),[g,S,e]),{inputOver:n,inputPeriodOver:a,btnDisabled:u,zeroInputBalance:d,bothConditionsErr:x}},W=n(27541),B=n(77751),U=n(27520);function K(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function R(e,t,n,o,r,a,l){try{var i=e[a](l),u=i.value}catch(c){return void n(c)}i.done?t(u):Promise.resolve(u).then(o,r)}function F(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var a=e.apply(t,n);function l(e){R(a,o,r,l,i,"next",e)}function i(e){R(a,o,r,l,i,"throw",e)}l(void 0)}))}}function Y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function G(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,a=[],l=!0,i=!1;try{for(n=n.call(e);!(l=(o=n.next()).done)&&(a.push(o.value),!t||a.length!==t);l=!0);}catch(u){i=!0,r=u}finally{try{l||null==n.return||n.return()}finally{if(i)throw r}}return a}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return K(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return K(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var $=function(){(0,l.F)();var e,t,n=(0,i.If)().colorMode,o=(0,b.Z)(),h=o.selectedModal,K=o.closeModal,R=o.isModalLoading,$=o.modalSectionMtValue,q=((0,T.Z)().bondModalData,(0,j.Z)().stakeV2,(0,A.Z)("Stake_screen","update_modal")),H=q.inputValue,J=q.setResetValue,Q=q.setValue,X=(0,g.Z)(),ee=X.StakingV2Proxy_CONTRACT,te=X.TOS_CONTRACT,ne=M.Z.StakingV2Proxy,oe=(0,O.Z)().userTOSBalance,re=(0,C.Z)().tosAllowance,ae=(0,y.useState)(!1),le=ae[0],ie=ae[1],ue=(0,y.useState)(!1),ce=ue[0],se=(ue[1],(0,y.useState)(!1)),de=se[0],pe=se[1],fe=(0,y.useState)(void 0),me=fe[0],xe=fe[1],be=(0,E.Z)().stakeId,he=(0,N.Z)(),ve=he.newEndTime,ke=he.leftWeeks,_e=he.leftDays,ye=he.leftTime,Se=(0,U.Z)().bp700px,ge=(0,P.Z)().setTx,Te=z(ke),we=Te.inputOver,Oe=Te.inputPeriodOver,je=Te.btnDisabled,Me=Te.zeroInputBalance,Ce=Te.bothConditionsErr,Ee=V.Z.errMsg,Ae=G((0,m.FV)(x.ws),2),Ne=(Ae[0],Ae[1]),Ze=G((0,m.FV)(x.lW),2),Ie=(Ze[0],Ze[1]),Le=(0,y.useCallback)(F(r().mark((function e(){var t,n;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!te){e.next=13;break}return e.next=4,te.totalSupply();case 4:return t=e.sent,e.next=7,te.approve(ne,t);case 7:if(n=e.sent,ge(n),!n){e.next=13;break}return e.next=12,n.wait();case 12:pe(!1);case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),pe(!1);case 18:case"end":return e.stop()}}),e,null,[[0,15]])}))),[te,ne,ge]),De=(0,y.useCallback)((function(){J(),K()}),[J,K]),Pe=(0,y.useCallback)(F(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(ee&&be&&ke>=0)){e.next=8;break}return console.log('StakingV2Proxy_CONTRACT[\n        "increaseBeforeEndOrNonEnd(uint256,uint256,uint256)"\n      ]'),console.log(be,(0,w.Az)(H.stake_updateModal_tos_balance),H.stake_updateModal_period-ke),e.next=5,ee["increaseBeforeEndOrNonEnd(uint256,uint256,uint256)"](be,(0,w.Az)(H.stake_updateModal_tos_balance),H.stake_updateModal_period-ke);case 5:return t=e.sent,ge(t),e.abrupt("return",De());case 8:case"end":return e.stop()}}),e)}))),[H.stake_updateModal_tos_balance,H.stake_updateModal_period,ee,be,ke,De,ge]);return(0,y.useEffect)((function(){return 2===me?ie(!0):re?0===re?ie(!1):re>=Number(H.stake_updateModal_tos_balance)?ie(!0):ie(!1):void 0}),[re,H.stake_updateModal_tos_balance,me]),(0,y.useEffect)((function(){return void 0!==H.stake_updateModal_tos_balance&&void 0!==H.stake_updateModal_period&&void 0!==ke?Number(H.stake_updateModal_tos_balance)>0&&H.stake_updateModal_period<=ke?xe(1):0===Number(H.stake_updateModal_tos_balance)&&H.stake_updateModal_period>ke?xe(2):xe(3):xe(void 0)}),[H,ke]),(0,y.useEffect)((function(){if(oe){var e=null===oe||void 0===oe?void 0:oe.replaceAll(",","").replaceAll(" ","");Q(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){Y(e,t,n[t])}))}return e}({},H,{stake_updateModal_tos_balance:e}))}}),[oe,Q,h]),(0,y.useEffect)((function(){Ie(!0)}),[H,Ie]),(0,y.useEffect)((function(){Ne(!0)}),[H.stake_modal_balance,Ne]),(0,a.jsxs)(u.u_,{isOpen:"stake_update_modal"===h,isCentered:!0,onClose:De,children:[(0,a.jsx)(c.Z,{className:"modalOverlayDrawer",bg:"none"}),(0,a.jsx)(s.h,{bg:"light"===n?"white.100":"#121318",minW:Se?"350px":"700px",maxW:Se?"350px":"700px",mt:$,children:(0,a.jsx)(d.f,{px:0,pt:"30px",children:(0,a.jsxs)(p.k,{w:"100%",flexDir:"column",children:[(0,a.jsxs)(p.k,{flexDir:"column",pos:"relative",children:[(0,a.jsxs)(p.k,{w:"100%",justifyContent:"center",mb:"33px",children:[(0,a.jsxs)(p.k,{flexDir:"column",alignItems:"center",children:[(0,a.jsx)(f.x,{color:"light"===n?"gray.800":"white.200",fontSize:20,fontWeight:600,children:"Manage"}),(0,a.jsx)(f.x,{height:"21px",color:"red.100",fontSize:15,mb:"6px",children:"Locked"}),(0,a.jsx)(f.x,{height:"17px",fontSize:12,color:"gray.100",children:"Increase LTOS & sTOS"})]}),(0,a.jsx)(p.k,{pos:"absolute",right:"1.56em",cursor:"pointer",onClick:function(){return De()},children:(0,a.jsx)(v(),{src:k.default,alt:"CLOSE_ICON"})})]}),(0,a.jsxs)(p.k,{w:"100%",px:Se?"20px":"120px",flexDir:"column",mb:"29px",children:[(0,a.jsx)(f.x,{color:"light"===n?"gray.800":"white.200",fontSize:12,mb:"10px",children:"Lock additional TOS"}),(0,a.jsx)(p.k,{mb:"9px",children:(0,a.jsx)(S.v,{w:"100%",h:45,placeHolder:"Enter an amount of TOS",pageKey:"Stake_screen",recoilKey:"update_modal",atomKey:"stake_updateModal_tos_balance",maxValue:Number(null===oe||void 0===oe?void 0:oe.replaceAll(",","").replaceAll(" ","")),isError:Ce||void 0===(null===H||void 0===H?void 0:H.stake_updateModal_tos_balance)||0===(null===H||void 0===H||null===(e=H.stake_updateModal_tos_balance)||void 0===e?void 0:e.length)||!0===ce&&Me||we,errorMsg:Ce?void 0:Me?Ee.zeroInput:Ee.balanceExceed,rightUnit:"TOS"})}),(0,a.jsxs)(p.k,{fontSize:12,color:"dark"===n?"#8b8b93":"gray.1000",h:"17px",justifyContent:"space-between",mb:Se?"22px":"12px",px:"6px",children:[(0,a.jsx)(f.x,{children:"Your Balance"}),(0,a.jsxs)(f.x,{children:[oe||"-"," TOS"]})]}),(0,a.jsx)(f.x,{color:"light"===n?"gray.800":"white.200",fontSize:12,mb:"10px",children:"New Lock-Up Period"}),(0,a.jsxs)(p.k,{w:Se?"100%":"",justifyContent:Se?"space-between":"",fontSize:12,alignItems:Se?"":"center",flexDir:Se?"column":"row",children:[(0,a.jsxs)(p.k,{w:Se?"100%":"204px",h:"39px",border:"dark"===n?"1px solid #313442":"1px solid #e8edf2",borderRadius:8,alignItems:"center",pl:"15px",fontSize:14,color:"#64646f",children:[(0,a.jsxs)(f.x,{children:[ke," ",ke<2?"Week":"Weeks"]}),(0,a.jsxs)(f.x,{fontSize:12,ml:"9px",mr:"3px",children:[_e," Days ",ye]}),(0,a.jsx)(p.k,{ml:Se?"auto":"",mr:Se?"8px":"",children:(0,a.jsx)(D.Z,{label:"This is the current Lock-Up period. The new Lock-Up period has to be equal or greater than this."})})]}),(0,a.jsx)(p.k,{mx:"14px",my:Se?"9px":"",justifyContent:Se?"center":"",children:(0,a.jsx)(v(),{src:Se?L.default:I.default,alt:"ArrowImg"})}),(0,a.jsx)(W.Z,{w:Se?"100%":"220px",h:"39px",atomKey:"stake_updateModal_period",pageKey:"Stake_screen",recoilKey:"update_modal",maxValue:V.Z.modalMaxWeeks,isError:Ce||Oe,isDisabled:ke===V.Z.modalMaxWeeks,isDisabledText:V.Z.modalMaxWeeks,errorMsg:Ce?void 0:Number(H.stake_updateModal_period)>155?Ee.periodExceedThanMaximum:Ee.managePeriodExceed,minValue:ke,leftDays:_e,leftTime:ye,endTime:Ce||Number(H.stake_updateModal_period)<ke||0===(null===H||void 0===H||null===(t=H.stake_updateModal_period)||void 0===t?void 0:t.length)||Number(H.stake_updateModal_period)>155?void 0:ve,isManageModal:!0})]})]}),(0,a.jsx)(p.k,{px:Se?"30px":"43px",mb:"30px",children:(0,a.jsx)(Z.default,{pageKey:"Stake_screen",subKey:"update_modal",periodKey:"stake_updateModal_period",balanceKey:"stake_updateModal_tos_balance",isSlideDisabled:!1,minValue:ke})}),(0,a.jsx)(B.default,{})]}),(0,a.jsx)(p.k,{justifyContent:"center",mb:"21px",children:le?(0,a.jsx)(_.Z,{w:Se?310:460,h:42,name:"Update",isDisabled:je||R,onClick:Pe}):(0,a.jsx)(_.Z,{w:Se?310:460,h:42,isDisabled:!0===Ce||we||Number(null===oe||void 0===oe?void 0:oe.replaceAll(",",""))<0||void 0===H.stake_updateModal_tos_balance||0===H.stake_updateModal_tos_balance.length||Oe||R,name:"Approve",isLoading:de,onClick:Le})}),!le&&(0,a.jsx)(p.k,{fontSize:11,color:"#64646f",textAlign:"center",w:"100%",mb:"24px",children:(0,a.jsx)(f.x,{w:"100%",color:"dark"===n?"gray.200":"gray.700",children:"Please approve your TOS to use this service"})}),Ce&&(0,a.jsx)(p.k,{fontSize:11,textAlign:"center",w:"100%",mb:"24px",children:(0,a.jsx)(f.x,{w:"100%",color:"red.100",fontWeight:"bold",children:"You have to lock additional TOS or/and increase the lock-up period by at least 1 week."})})]})})})]})}},77751:function(e,t,n){n.r(t),n.d(t,{default:function(){return C}});var o=n(85893),r=n(67294),a=n(45093),l=n(18618),i=n(93717),u=n(54968),c=n(5835),s=n(88586),d=n(83077),p=n(60938),f=n(34051),m=n.n(f),x=n(79102),b=n(89406),h=n(68462);function v(e,t,n,o,r,a,l){try{var i=e[a](l),u=i.value}catch(c){return void n(c)}i.done?t(u):Promise.resolve(u).then(o,r)}function k(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var a=e.apply(t,n);function l(e){v(a,o,r,l,i,"next",e)}function i(e){v(a,o,r,l,i,"throw",e)}l(void 0)}))}}var _=function(){var e=(0,r.useState)(void 0),t=e[0],n=e[1],o=(0,b.Z)(),a=(o.stakeId,o.connectId),l=(0,h.Z)().LockTOS_CONTRACT;return(0,r.useEffect)((function(){function e(){return(e=k(m().mark((function e(){var t,o,r,i;return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!a||!l){e.next=8;break}return e.next=3,l.locksInfo(a);case 3:t=e.sent,o=t.amount,r=t.end.toString(),i=(0,x.WN)({amount:o})||"0",n({amount:Number(i.replaceAll(",","")),amountBN:o,endTime:Number(r)});case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(function(){return e.apply(this,arguments)})().catch((function(e){console.log("**useLocksInfo err**"),console.log(e)}))}),[a,l]),{locksInfo:t}},y=n(5371);var S=function(){var e=(0,p.Z)("Stake_screen","update_modal").inputValue,t=Number(e.stake_updateModal_tos_balance),n=(0,y.Z)().leftWeeks,o=Number(e.stake_updateModal_period)-n,a=s.Z.rebasePerEpoch,l=_().locksInfo,i=(0,d.O)().blockTimeStamp,u=(0,r.useMemo)((function(){if((null===l||void 0===l?void 0:l.endTime)&&i&&void 0!==o)return(l.endTime-i)/604800+o}),[null===l||void 0===l?void 0:l.endTime,i,o]),c=(0,r.useMemo)((function(){if((null===l||void 0===l?void 0:l.amount)&&a&&void 0!==o)return l.amount*Math.pow(1+a,21*o)}),[null===l||void 0===l?void 0:l.amount,a,o]),f=(0,r.useMemo)((function(){if((null===l||void 0===l?void 0:l.endTime)&&i&&void 0!==o)return Math.floor((l.endTime-i+604800*o)/28800)}),[null===l||void 0===l?void 0:l.endTime,i,o]),m=(0,r.useMemo)((function(){if(void 0!==t&&a&&f&&c)return t*Math.pow(1+a,f)+c}),[t,a,f,c]);return{newBalanceStos:(0,r.useMemo)((function(){if(void 0!==m&&void 0!==u)return m*u/156}),[m,u])}},g=n(27520),T=n(68506),w=n(4480);function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,a=[],l=!0,i=!1;try{for(n=n.call(e);!(l=(o=n.next()).done)&&(a.push(o.value),!t||a.length!==t);l=!0);}catch(u){i=!0,r=u}finally{try{l||null==n.return||n.return()}finally{if(i)throw r}}return a}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var C=function(){var e=M((0,l.a)("(max-width: 1024px)"),1)[0],t=(0,p.Z)("Stake_screen","update_modal"),n=t.inputValue,s=(t.setResetValue,t.setValue,(0,y.Z)()),d=s.currentEndTime,f=s.newEndTime,m=(s.leftWeeks,s.leftDays,s.leftTime,s.newLtosBalance),x=s.totalTosAmount,b=null!==(b=S())?b:function(e){throw e}(new TypeError("Cannot destructure undefined")),h=(0,c.Z)(),v=M((0,w.FV)(u.ws),2),k=v[0],_=(v[1],(0,w.sJ)(u.lW),S().newBalanceStos),O=(0,g.Z)().bp700px,C=[{title:"You Give",content:"".concat(n.stake_updateModal_tos_balance||"0"," TOS")},{title:"Current Balance",content:"".concat((null===h||void 0===h?void 0:h.ltosBalance)||"-"," LTOS"),secondContent:"".concat((null===h||void 0===h?void 0:h.stosBalance)||"-"," sTOS"),tooltip:"Amount of LTOS and sTOS before the update.",secondTooltip:"Currently worth ".concat((null===h||void 0===h?void 0:h.currentTosAmount)||"-"," TOS. As LTOS index increases, the number of TOS you can get from unstaking LTOS will also increase."),thirdTooltip:"sTOS\u2019s lock-up period is calculated relative to Thursday 0:00 (UTC+0)."},{title:"New Balance",content:k?"......":"".concat(m," LTOS"),secondContent:"".concat((0,a.Z)(_)," sTOS"),tooltip:"Amount of LTOS and sTOS after the update.",secondTooltip:"Currently worth ".concat(x," TOS. As LTOS index increases, the number of TOS you can get from unstaking LTOS will also increase."),thirdTooltip:"sTOS\u2019s lock-up period is calculated relative to Thursday 00:00 (UTC+0)."},{title:"Current End Time",content:d,tooltip:"Lock-Up period end time before the update before the update.",contentFontSize:O?12:14},{title:"New End Time",content:f,tooltip:"Lock-Up period end time after the update before the update.",contentFontSize:O?12:14}];return(0,o.jsx)(i.k,{flexDir:"column",columnGap:"9px",mb:"30px",px:e?"20px":"50px",children:C.map((function(e){return(0,r.createElement)(T.default,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){j(e,t,n[t])}))}return e}({},e,{key:e.title}))}))})}}}]);