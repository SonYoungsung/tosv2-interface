"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8091],{38091:function(e,t,n){n.r(t),n.d(t,{default:function(){return W}});var o=n(34051),r=n.n(o),l=n(85893),a=n(48940),i=n(45161),c=n(35541),s=n(19778),u=n(14581),d=n(54346),p=n(93717),f=n(71293),k=n(37243),b=n(25675),x=n.n(b),m=n(79822),_=n(79859),h=n(60483),S=n(67294),v=n(26882),y=n(68462),g=n(79102),O=n(29619),T=n(46850),j=n(28450),w=n(43382),M=n(60938),A=n(31617),Z=n(95787),C=n(88586),L=n(60316),E=n(57683);var N=function(e){var t=(0,S.useState)(!1),n=t[0],o=t[1],r=(0,S.useState)(!1),l=r[0],a=r[1],i=(0,S.useState)(!0),c=i[0],s=i[1],u=(0,S.useState)(!1),d=u[0],p=u[1],f=(0,O.Z)().userTOSBalance,b=(0,k.Z)().isModalLoading,x=(0,M.Z)("Stake_screen","relock_modal").inputValue,m=x.stake_relockModal_tos_balance,_=x.stake_relockModal_ltos_balance,h=x.stake_relockModal_period,v=C.Z.modalMaxWeeks;return(0,S.useEffect)((function(){return b?(p(!1),o(!1)):void 0===m||0===m.length||Number(m)<=0?(p(!0),o(!1)):f&&m?Number(m)>Number(f.replaceAll(",",""))?(p(!1),o(!0)):(p(!1),o(!1)):function(){p(!1),o(!1)}}),[m,f,b]),(0,S.useEffect)((function(){return b?p(!1):void 0===_||0===_.length||Number(_)<=0?(p(!0),o(!1)):e&&_?Number(_)>e?(p(!1),o(!0)):(p(!1),o(!1)):function(){p(!1),o(!1)}}),[_,e,b]),(0,S.useEffect)((function(){return Number(h)>v||Number(h)<0||0===(null===h||void 0===h?void 0:h.length)?a(!0):a(!1)}),[h,v,b]),(0,S.useEffect)((function(){s(n||l||d)}),[n,l,d]),{inputOver:n,inputPeriodOver:l,zeroInputBalance:d,btnDisabled:c}},D=n(74506),V=n(27541),P=n(19400),z=n(27520);function I(e,t,n,o,r,l,a){try{var i=e[l](a),c=i.value}catch(s){return void n(s)}i.done?t(c):Promise.resolve(c).then(o,r)}function B(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var l=e.apply(t,n);function a(e){I(l,o,r,a,i,"next",e)}function i(e){I(l,o,r,a,i,"throw",e)}a(void 0)}))}}function K(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){K(e,t,n[t])}))}return e}var W=function(){(0,a.F)();var e=(0,i.If)().colorMode,t=(0,k.Z)().closeModal,n=(0,k.Z)(),o=n.selectedModalData,b=n.selectedModal,I=n.modalSectionMtValue,K=((0,T.Z)().stakeV2,(0,S.useState)(!1)),W=K[0],R=K[1],U=(0,M.Z)("Stake_screen","relock_modal"),H=U.inputValue,Y=U.setResetValue,F=U.setValue,J=(0,z.Z)().bp700px,$=(0,y.Z)(),q=$.StakingV2Proxy_CONTRACT,Q=$.TOS_CONTRACT,X=j.Z.StakingV2Proxy,ee=(0,O.Z)(),te=ee.userTOSBalance,ne=(ee.userLTOSBalance,(0,w.Z)().tosAllowance),oe=(0,S.useState)(!1),re=oe[0],le=oe[1],ae=(0,A.Z)(W),ie=ae.newEndTime,ce=(ae.inputTosAmount,ae.tosValue,(0,D.Z)(H.stake_relockModal_ltos_balance,H.stake_relockModal_period)),se=ce.leftDays,ue=ce.leftHourAndMin,de=(0,E.Z)().setTx,pe=null===o||void 0===o?void 0:o.stakeId,fe=null===o||void 0===o?void 0:o.ltosAmount,ke=N(Number(null===fe||void 0===fe?void 0:fe.replaceAll("",""))),be=ke.inputOver,xe=ke.inputPeriodOver,me=ke.btnDisabled,_e=ke.zeroInputBalance,he=C.Z.errMsg,Se=C.Z.modalMaxWeeks,ve=(0,S.useState)(void 0),ye=(ve[0],ve[1],(0,S.useState)(void 0)),ge=(ye[0],ye[1],(0,S.useCallback)((function(){Y(),R(!1),t()}),[Y,t])),Oe=(0,S.useCallback)(B(r().mark((function e(){var t,n,o,l,a,i,c;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(q&&pe&&(null===(t=String(H.stake_relockModal_period))||void 0===t?void 0:t.length)>0)){e.next=21;break}if(o=H.stake_relockModal_period+1,!(W&&(void 0!==H.stake_relockModal_tos_balance||(null===(n=H.stake_relockModal_tos_balance)||void 0===n?void 0:n.length)>0)&&fe)){e.next=14;break}return l=Number(null===fe||void 0===fe?void 0:fe.replaceAll(",","").replaceAll(" ","")),a=(0,g.Az)(l.toString()),console.log("resetStakeGetStosAfterLock(uint256,uint256,uint256, uint256)"),console.log(pe,(0,g.Az)(H.stake_relockModal_tos_balance),a,o),e.next=11,q["resetStakeGetStosAfterLock(uint256,uint256,uint256,uint256)"](pe,(0,g.Az)(H.stake_relockModal_tos_balance),a,o);case 11:return i=e.sent,de(i),e.abrupt("return",ge());case 14:return console.log("resetStakeGetStosAfterLock(uint256,uint256,uint256,uint256)"),console.log(pe,0,(0,g.Az)(H.stake_relockModal_ltos_balance),o),e.next=18,q["resetStakeGetStosAfterLock(uint256,uint256,uint256,uint256)"](pe,0,(0,g.Az)(H.stake_relockModal_ltos_balance),o);case 18:return c=e.sent,de(c),e.abrupt("return",ge());case 21:case"end":return e.stop()}}),e)}))),[q,pe,W,H,de,ge,fe]),Te=(0,S.useCallback)(B(r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Q){e.next=5;break}return e.next=3,Q.totalSupply();case 3:return t=e.sent,e.abrupt("return",Q.approve(X,t));case 5:case"end":return e.stop()}}),e)}))),[Q,X]);return(0,S.useEffect)((function(){if(ne&&H.stake_relockModal_tos_balance)return 0===ne?le(!1):ne>=Number(H.stake_relockModal_tos_balance)?le(!0):le(!1)}),[ne,H.stake_relockModal_tos_balance]),(0,S.useEffect)((function(){fe&&te&&F(G({},H,{stake_relockModal_ltos_balance:fe.replaceAll(",",""),stake_relockModal_tos_balance:te.replaceAll(",","")})),W&&fe&&F(G({},H,{stake_relockModal_ltos_balance:fe.replaceAll(",","")}))}),[fe,te,F,W,b]),(0,l.jsxs)(c.u_,{isOpen:"stake_updateAfterEndTime_modal"===b,isCentered:!0,onClose:ge,children:[(0,l.jsx)(s.Z,{className:"modalOverlayDrawer",bg:"none"}),(0,l.jsx)(u.h,{bg:"light"===e?"white.100":"#121318",minW:J?"350px":"700px",maxW:J?"350px":"700px",mt:I,children:(0,l.jsx)(d.f,{px:0,pt:"30px",children:(0,l.jsxs)(p.k,{w:"100%",flexDir:"column",children:[(0,l.jsxs)(p.k,{flexDir:"column",pos:"relative",children:[(0,l.jsxs)(p.k,{w:"100%",justifyContent:"center",mb:"33px",children:[(0,l.jsxs)(p.k,{flexDir:"column",alignItems:"center",children:[(0,l.jsx)(f.x,{color:"light"===e?"gray.800":"white.200",fontSize:20,fontWeight:600,children:"Relock"}),(0,l.jsx)(f.x,{height:"21px",color:"blue.200",fontSize:15,mb:"6px",children:"Unlocked"}),(0,l.jsx)(f.x,{height:"17px",fontSize:12,color:"gray.100",children:"Relock LTOS and lock more TOS for LTOS & sTOS"})]}),(0,l.jsx)(p.k,{pos:"absolute",right:"1.56em",cursor:"pointer",onClick:function(){return ge()},children:(0,l.jsx)(x(),{src:m.default,alt:"CLOSE_ICON"})})]}),(0,l.jsxs)(p.k,{w:"100%",px:J?"20px":"120px",flexDir:"column",mb:"29px",children:[(0,l.jsxs)(p.k,{mb:"9px",justifyContent:"space-between",alignItems:"center",flexDir:"column",rowGap:"9px",children:[(0,l.jsxs)(p.k,{w:"100%",justifyContent:"space-between",children:[(0,l.jsx)(f.x,{fontSize:12,color:"light"===e?"gray.800":"white.200",children:"Relock LTOS"}),(0,l.jsxs)(p.k,{alignItems:"center",children:[(0,l.jsx)(_.Z,{state:W,setState:R}),(0,l.jsx)(f.x,{ml:"14px",fontSize:12,mr:"6px",color:"dark"===e?"#8b8b93":"gray.1000",children:"Lock additional TOS"}),(0,l.jsx)(Z.Z,{label:"If you want more sTOS, you can lock TOS in addition to restaking your LTOS. "})]})]}),(0,l.jsx)(p.k,{w:"100%",children:(0,l.jsx)(v.v,{w:J?"100%":"460px",h:45,placeHolder:"Enter an amount of LTOS",atomKey:"stake_relockModal_ltos_balance",pageKey:"Stake_screen",recoilKey:"relock_modal",isDisabled:W,maxValue:Number(null===fe||void 0===fe?void 0:fe.replaceAll(",","").replaceAll(" ","")),isError:!1===W&&(_e||be),errorMsg:_e?he.bondZeroInput:he.balanceExceed,rightUnit:"LTOS"})})]}),(0,l.jsxs)(p.k,{fontSize:12,color:"dark"===e?"#8b8b93":"gray.1000",h:"17px",justifyContent:"space-between",mb:J&&!1===W?"23px":"12px",w:"100%",px:"6px",children:[(0,l.jsx)(f.x,{children:"Your Balance"}),(0,l.jsxs)(f.x,{children:[fe," LTOS"]})]}),W&&(0,l.jsxs)(p.k,{mb:"12px",flexDir:"column",children:[(0,l.jsx)(p.k,{mb:"9px",children:(0,l.jsx)(v.v,{w:"100%",h:45,placeHolder:"Enter an amount of TOS",pageKey:"Stake_screen",recoilKey:"relock_modal",atomKey:"stake_relockModal_tos_balance",maxValue:Number(null===te||void 0===te?void 0:te.replaceAll(",","")),isError:_e||be,errorMsg:W&&_e?he.bondZeroInput:he.balanceExceed,rightUnit:"TOS"})}),(0,l.jsxs)(p.k,{fontSize:12,color:"dark"===e?"#8b8b93":"gray.1000",h:"17px",justifyContent:"space-between",mb:"12px",children:[(0,l.jsx)(f.x,{children:"Your Balance"}),(0,l.jsxs)(f.x,{children:[te||"-"," TOS"]})]})]}),(0,l.jsxs)(p.k,{fontSize:12,alignItems:J?"":"center",justifyContent:J?"":"space-between",w:J?"100%":"",mb:J?"10px":"",flexDir:J?"column":"row",children:[(0,l.jsx)(f.x,{mr:"24px",mb:J?"10px":"",color:"light"===e?"gray.800":"white.200",children:"New Lock-Up Period"}),(0,l.jsx)(V.Z,{w:J?"100%":"220px",h:"39px",pageKey:"Stake_screen",recoilKey:"relock_modal",atomKey:"stake_relockModal_period",placeHolder:"1 Weeks",style:J?{}:{marginLeft:"auto"},maxValue:Se,isError:xe,errorMsg:he.stakePeriodExceed,isDisabled:!1,leftDays:se,leftTime:ue,endTime:xe?void 0:ie})]})]}),(0,l.jsx)(p.k,{px:J?"30px":"43px",mb:"30px",children:(0,l.jsx)(L.default,{pageKey:"Stake_screen",periodKey:"stake_relockModal_period",subKey:"relock_modal",isSlideDisabled:!1})}),(0,l.jsx)(P.default,{addTos:W})]}),(0,l.jsx)(p.k,{justifyContent:"center",mb:"21px",children:re?(0,l.jsx)(h.Z,{w:J?310:460,h:42,name:"Update",isDisabled:me,onClick:Oe}):(0,l.jsx)(h.Z,{w:J?310:460,h:42,name:"Approve",onClick:Te,isDisabled:_e||be||xe})})]})})})]})}},19400:function(e,t,n){n.r(t),n.d(t,{default:function(){return S}});var o=n(85893),r=n(67294),l=n(45093),a=n(93717),i=n(54968),c=n(46850),s=n(83077),u=n(60938),d=n(74506),p=n(31617);var f=function(e){var t,n=(0,u.Z)("Stake_screen","relock_modal").inputValue,o=(0,p.Z)(e),l=(o.newEndTime,o.inputTosAmount,o.tosValue),a=o.allLtosToTosBalance,i=e&&a?Number(null===n||void 0===n||null===(t=n.stake_relockModal_tos_balance)||void 0===t?void 0:t.replaceAll(",",""))+a:Number(l.replaceAll(",","")),f=(0,d.Z)(0,n.stake_relockModal_period),k=f.leftDays,b=f.leftHourAndMin,x=Number(n.stake_relockModal_period),m=(0,r.useMemo)((function(){if(void 0!==k&&void 0!==b&&void 0!==x)return(86400*Number(k)+3600*Number(b.split(":")[0])+60*Number(b.split(":")[1]))/604800+x}),[k,b,x]),_=(0,c.Z)().rebasePerEpoch,h=((0,s.O)().blockTimeStamp,(0,r.useMemo)((function(){if(void 0!==m)return Math.floor(21*m)}),[m])),S=(0,r.useMemo)((function(){if(void 0!==i&&_&&h)return i*Math.pow(1+_,h)}),[i,_,h]);return{newBalanceStos:(0,r.useMemo)((function(){if(void 0!==S&&void 0!==m)return S*m/156}),[S,m])}},k=n(27520),b=n(68506),x=n(4480);function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,l=[],a=!0,i=!1;try{for(n=n.call(e);!(a=(o=n.next()).done)&&(l.push(o.value),!t||l.length!==t);a=!0);}catch(c){i=!0,r=c}finally{try{a||null==n.return||n.return()}finally{if(i)throw r}}return l}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var S=function(e){var t,n=e.addTos,c=(0,k.Z)().bp700px,s=(0,u.Z)("Stake_screen","relock_modal"),d=s.inputValue,m=(s.setResetValue,s.setValue,(0,p.Z)(n)),S=m.newEndTime,v=m.tosValue,y=m.tosBalance,g=m.allLtosBalance,O=(m.allLtosToTosBalance,f(n).newBalanceStos),T=h((0,x.FV)(i.ws),2),j=(T[0],T[1],(0,x.sJ)(i.lW),[{title:"You Give",content:"".concat(null!==(t=(0,l.Z)(d.stake_relockModal_ltos_balance))&&void 0!==t?t:"-"," LTOS"),secondContent:n?"".concat(d.stake_relockModal_tos_balance," TOS"):void 0,tooltip:"Amount of LTOS and TOS used for staking.",secondTooltip:"Currently worth ".concat(v||"-"," TOS. As LTOS index increases, the number of TOS you can get from unstaking LTOS will also increase.")},{title:"You Will Get",content:"".concat(n?g:(0,l.Z)(d.stake_relockModal_ltos_balance)," LTOS"),secondContent:"".concat((0,l.Z)(O)," sTOS"),thirdContent:n?void 0:"".concat(y," TOS"),tooltip:"Amount of LTOS, sTOS, and TOS you will get after the update. ",secondTooltip:"Currently worth ".concat(v," TOS. As LTOS index increases, the number of TOS you can get from unstaking LTOS will also increase."),thirdTooltip:"sTOS\u2019s lock-up period is calculated relative to Thursday 00:00 (UTC+0).",fourthTooltip:n?void 0:"Any LTOS that does not get relocked is returned to you in TOS."},{title:"New End Time",content:S,tooltip:"LTOS can be unstaked after this time."}]);return(0,o.jsx)(a.k,{flexDir:"column",columnGap:"9px",mb:"30px",px:c?"20px":"50px",children:j.map((function(e){return(0,r.createElement)(b.default,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),o.forEach((function(t){_(e,t,n[t])}))}return e}({},e,{key:e.title}))}))})}}}]);