"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8091],{80966:function(e,t,n){n.d(t,{Y_:function(){return a},ac:function(){return l},oM:function(){return o}});var r=n(4480),o=(0,r.cn)({key:"checkAllValue",default:void 0}),l=(0,r.cn)({key:"checkboxValue",default:[]}),a=(0,r.nZ)({key:"selectedCheckboxValues",get:function(e){return(0,e.get)(l)},set:function(e,t){(0,e.set)(l,t)}})},79859:function(e,t,n){var r=n(85893),o=n(48940),l=n(45161),a=n(88772),i=n(80966),c=n(27224),u=n(67294),s=n(4480);function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,l=[],a=!0,i=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);a=!0);}catch(c){i=!0,o=c}finally{try{a||null==n.return||n.return()}finally{if(i)throw o}}return l}}(e,t)||k(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||k(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){if(e){if("string"===typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}t.Z=function(e){e.placeHolder,e.w,e.h,e.isDisabled,e.value,e.valueKey;var t=e.pageKey,n=(e.isError,e.isChecked,e.state),d=e.setState,k=(e.action,e.elseAction,e.checkAll),b=e.params,m=e.belongToSelectAll,x=((0,o.F)(),(0,l.If)().colorMode),h=((0,c.Z)().pathName,f((0,s.FV)(i.oM),2)),v=h[0],y=h[1],S=f((0,s.FV)(i.ac),2),_=S[0],g=S[1],O=(0,s.rb)(i.ac),T=(0,u.useState)(n||!1),j=T[0],w=T[1];return(0,u.useEffect)((function(){m&&w(!(!t||v!==t))}),[v,t,d,m]),(0,u.useEffect)((function(){if(j&&_&&b&&0===(null===_||void 0===_?void 0:_.filter((function(e){if(null===e||void 0===e?void 0:e.stakedId)return e.stakedId===b.stakedId}))).length){var e=p(_).concat([b]);return g(e)}}),[b,j,_,g]),(0,u.useEffect)((function(){if(!1===j&&_&&b&&1===(null===_||void 0===_?void 0:_.filter((function(e){if(null===e||void 0===e?void 0:e.stakedId)return e.stakedId===b.stakedId}))).length){var e=null===_||void 0===_?void 0:_.filter((function(e){if(null===e||void 0===e?void 0:e.stakedId)return e.stakedId!==b.stakedId}));g(e)}}),[j,_,b,g]),(0,r.jsx)(a.X,{size:"lg",style:{borderRadius:"4px",borderColor:"dark"===x?"#535353":"#c6cbd9"},isChecked:m?j:n,onChange:function(e){var n=e.target.checked;d?d(n):w(n),k&&t&&(n?y(t):O())}})}},27224:function(e,t,n){var r=n(11163),o=n(67294);t.Z=function(){var e=(0,o.useState)(void 0),t=e[0],n=e[1],l=(0,r.useRouter)().pathname;return(0,o.useEffect)((function(){var e=l.replaceAll("/",""),t="dao"!==e?e.charAt(0).toUpperCase()+e.slice(1):"DAO";return n(t)}),[l]),{pathName:t}}},38091:function(e,t,n){n.r(t),n.d(t,{default:function(){return U}});var r=n(34051),o=n.n(r),l=n(85893),a=n(48940),i=n(45161),c=n(35541),u=n(19778),s=n(14581),d=n(54346),f=n(93717),p=n(71293),k=n(37243),b=n(25675),m=n.n(b),x=n(79822),h=n(79859),v=n(60483),y=n(67294),S=n(26882),_=n(68462),g=n(79102),O=n(29619),T=n(46850),j=n(28450),w=n(43382),A=n(60938),M=n(31617),Z=n(95787),C=n(88586),E=n(60316),I=n(57683);var L=function(e){var t=(0,y.useState)(!1),n=t[0],r=t[1],o=(0,y.useState)(!1),l=o[0],a=o[1],i=(0,y.useState)(!0),c=i[0],u=i[1],s=(0,y.useState)(!1),d=s[0],f=s[1],p=(0,O.Z)().userTOSBalance,b=(0,k.Z)().isModalLoading,m=(0,A.Z)("Stake_screen","relock_modal").inputValue,x=m.stake_relockModal_tos_balance,h=m.stake_relockModal_ltos_balance,v=m.stake_relockModal_period,S=C.Z.modalMaxWeeks;return(0,y.useEffect)((function(){return b?(f(!1),r(!1)):void 0===x||0===x.length||Number(x)<=0?(f(!0),r(!1)):p&&x?Number(x)>Number(p.replaceAll(",",""))?(f(!1),r(!0)):(f(!1),r(!1)):function(){f(!1),r(!1)}}),[x,p,b]),(0,y.useEffect)((function(){return b?f(!1):void 0===h||0===h.length||Number(h)<=0?(f(!0),r(!1)):e&&h?Number(h)>e?(f(!1),r(!0)):(f(!1),r(!1)):function(){f(!1),r(!1)}}),[h,e,b]),(0,y.useEffect)((function(){return Number(v)>S||Number(v)<0||0===(null===v||void 0===v?void 0:v.length)?a(!0):a(!1)}),[v,S,b]),(0,y.useEffect)((function(){u(n||l||d)}),[n,l,d]),{inputOver:n,inputPeriodOver:l,zeroInputBalance:d,btnDisabled:c}},N=n(74506),D=n(27541),V=n(19400),P=n(27520);function z(e,t,n,r,o,l,a){try{var i=e[l](a),c=i.value}catch(u){return void n(u)}i.done?t(c):Promise.resolve(c).then(r,o)}function K(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var l=e.apply(t,n);function a(e){z(l,r,o,a,i,"next",e)}function i(e){z(l,r,o,a,i,"throw",e)}a(void 0)}))}}function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){B(e,t,n[t])}))}return e}var U=function(){(0,a.F)();var e=(0,i.If)().colorMode,t=(0,k.Z)().closeModal,n=(0,k.Z)(),r=n.selectedModalData,b=n.selectedModal,z=n.modalSectionMtValue,B=((0,T.Z)().stakeV2,(0,y.useState)(!1)),U=B[0],G=B[1],W=(0,A.Z)("Stake_screen","relock_modal"),H=W.inputValue,F=W.setResetValue,Y=W.setValue,$=(0,P.Z)().bp700px,J=(0,_.Z)(),X=J.StakingV2Proxy_CONTRACT,q=J.TOS_CONTRACT,Q=j.Z.StakingV2Proxy,ee=(0,O.Z)(),te=ee.userTOSBalance,ne=(ee.userLTOSBalance,(0,w.Z)().tosAllowance),re=(0,y.useState)(!1),oe=re[0],le=re[1],ae=(0,M.Z)(U),ie=ae.newEndTime,ce=(ae.inputTosAmount,ae.tosValue,(0,N.Z)(H.stake_relockModal_ltos_balance,H.stake_relockModal_period)),ue=ce.leftDays,se=ce.leftHourAndMin,de=(0,I.Z)().setTx,fe=null===r||void 0===r?void 0:r.stakeId,pe=null===r||void 0===r?void 0:r.ltosAmount,ke=L(Number(null===pe||void 0===pe?void 0:pe.replaceAll("",""))),be=ke.inputOver,me=ke.inputPeriodOver,xe=ke.btnDisabled,he=ke.zeroInputBalance,ve=C.Z.errMsg,ye=C.Z.modalMaxWeeks,Se=(0,y.useState)(void 0),_e=(Se[0],Se[1],(0,y.useState)(void 0)),ge=(_e[0],_e[1],(0,y.useCallback)((function(){F(),G(!1),t()}),[F,t])),Oe=(0,y.useCallback)(K(o().mark((function e(){var t,n,r,l,a,i,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(X&&fe&&(null===(t=String(H.stake_relockModal_period))||void 0===t?void 0:t.length)>0)){e.next=21;break}if(r=H.stake_relockModal_period+1,!(U&&(void 0!==H.stake_relockModal_tos_balance||(null===(n=H.stake_relockModal_tos_balance)||void 0===n?void 0:n.length)>0)&&pe)){e.next=14;break}return l=Number(null===pe||void 0===pe?void 0:pe.replaceAll(",","").replaceAll(" ","")),a=(0,g.Az)(l.toString()),console.log("resetStakeGetStosAfterLock(uint256,uint256,uint256, uint256)"),console.log(fe,(0,g.Az)(H.stake_relockModal_tos_balance),a,r),e.next=11,X["resetStakeGetStosAfterLock(uint256,uint256,uint256,uint256)"](fe,(0,g.Az)(H.stake_relockModal_tos_balance),a,r);case 11:return i=e.sent,de(i),e.abrupt("return",ge());case 14:return console.log("resetStakeGetStosAfterLock(uint256,uint256,uint256,uint256)"),console.log(fe,0,(0,g.Az)(H.stake_relockModal_ltos_balance),r),e.next=18,X["resetStakeGetStosAfterLock(uint256,uint256,uint256,uint256)"](fe,0,(0,g.Az)(H.stake_relockModal_ltos_balance),r);case 18:return c=e.sent,de(c),e.abrupt("return",ge());case 21:case"end":return e.stop()}}),e)}))),[X,fe,U,H,de,ge,pe]),Te=(0,y.useCallback)(K(o().mark((function e(){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!q){e.next=5;break}return e.next=3,q.totalSupply();case 3:return t=e.sent,e.abrupt("return",q.approve(Q,t));case 5:case"end":return e.stop()}}),e)}))),[q,Q]);return(0,y.useEffect)((function(){if(ne&&H.stake_relockModal_tos_balance)return 0===ne?le(!1):ne>=Number(H.stake_relockModal_tos_balance)?le(!0):le(!1)}),[ne,H.stake_relockModal_tos_balance]),(0,y.useEffect)((function(){pe&&te&&Y(R({},H,{stake_relockModal_ltos_balance:pe.replaceAll(",",""),stake_relockModal_tos_balance:te.replaceAll(",","")})),U&&pe&&Y(R({},H,{stake_relockModal_ltos_balance:pe.replaceAll(",","")}))}),[pe,te,Y,U,b]),(0,l.jsxs)(c.u_,{isOpen:"stake_updateAfterEndTime_modal"===b,isCentered:!0,onClose:ge,children:[(0,l.jsx)(u.Z,{className:"modalOverlayDrawer",bg:"none"}),(0,l.jsx)(s.h,{bg:"light"===e?"white.100":"#121318",minW:$?"350px":"700px",maxW:$?"350px":"700px",mt:z,children:(0,l.jsx)(d.f,{px:0,pt:"30px",children:(0,l.jsxs)(f.k,{w:"100%",flexDir:"column",children:[(0,l.jsxs)(f.k,{flexDir:"column",pos:"relative",children:[(0,l.jsxs)(f.k,{w:"100%",justifyContent:"center",mb:"33px",children:[(0,l.jsxs)(f.k,{flexDir:"column",alignItems:"center",children:[(0,l.jsx)(p.x,{color:"light"===e?"gray.800":"white.200",fontSize:20,fontWeight:600,children:"Relock"}),(0,l.jsx)(p.x,{height:"21px",color:"blue.200",fontSize:15,mb:"6px",children:"Unlocked"}),(0,l.jsx)(p.x,{height:"17px",fontSize:12,color:"gray.100",children:"Relock LTOS and lock more TOS for LTOS & sTOS"})]}),(0,l.jsx)(f.k,{pos:"absolute",right:"1.56em",cursor:"pointer",onClick:function(){return ge()},children:(0,l.jsx)(m(),{src:x.default,alt:"CLOSE_ICON"})})]}),(0,l.jsxs)(f.k,{w:"100%",px:$?"20px":"120px",flexDir:"column",mb:"29px",children:[(0,l.jsxs)(f.k,{mb:"9px",justifyContent:"space-between",alignItems:"center",flexDir:"column",rowGap:"9px",children:[(0,l.jsxs)(f.k,{w:"100%",justifyContent:"space-between",children:[(0,l.jsx)(p.x,{fontSize:12,color:"light"===e?"gray.800":"white.200",children:"Relock LTOS"}),(0,l.jsxs)(f.k,{alignItems:"center",children:[(0,l.jsx)(h.Z,{state:U,setState:G}),(0,l.jsx)(p.x,{ml:"14px",fontSize:12,mr:"6px",color:"dark"===e?"#8b8b93":"gray.1000",children:"Lock additional TOS"}),(0,l.jsx)(Z.Z,{label:"If you want more sTOS, you can lock TOS in addition to restaking your LTOS. "})]})]}),(0,l.jsx)(f.k,{w:"100%",children:(0,l.jsx)(S.v,{w:$?"100%":"460px",h:45,placeHolder:"Enter an amount of LTOS",atomKey:"stake_relockModal_ltos_balance",pageKey:"Stake_screen",recoilKey:"relock_modal",isDisabled:U,maxValue:Number(null===pe||void 0===pe?void 0:pe.replaceAll(",","").replaceAll(" ","")),isError:!1===U&&(he||be),errorMsg:he?ve.bondZeroInput:ve.balanceExceed,rightUnit:"LTOS"})})]}),(0,l.jsxs)(f.k,{fontSize:12,color:"dark"===e?"#8b8b93":"gray.1000",h:"17px",justifyContent:"space-between",mb:$&&!1===U?"23px":"12px",w:"100%",px:"6px",children:[(0,l.jsx)(p.x,{children:"Your Balance"}),(0,l.jsxs)(p.x,{children:[pe," LTOS"]})]}),U&&(0,l.jsxs)(f.k,{mb:"12px",flexDir:"column",children:[(0,l.jsx)(f.k,{mb:"9px",children:(0,l.jsx)(S.v,{w:"100%",h:45,placeHolder:"Enter an amount of TOS",pageKey:"Stake_screen",recoilKey:"relock_modal",atomKey:"stake_relockModal_tos_balance",maxValue:Number(null===te||void 0===te?void 0:te.replaceAll(",","")),isError:he||be,errorMsg:U&&he?ve.bondZeroInput:ve.balanceExceed,rightUnit:"TOS"})}),(0,l.jsxs)(f.k,{fontSize:12,color:"dark"===e?"#8b8b93":"gray.1000",h:"17px",justifyContent:"space-between",mb:"12px",children:[(0,l.jsx)(p.x,{children:"Your Balance"}),(0,l.jsxs)(p.x,{children:[te||"-"," TOS"]})]})]}),(0,l.jsxs)(f.k,{fontSize:12,alignItems:$?"":"center",justifyContent:$?"":"space-between",w:$?"100%":"",mb:$?"10px":"",flexDir:$?"column":"row",children:[(0,l.jsx)(p.x,{mr:"24px",mb:$?"10px":"",color:"light"===e?"gray.800":"white.200",children:"New Lock-Up Period"}),(0,l.jsx)(D.Z,{w:$?"100%":"220px",h:"39px",pageKey:"Stake_screen",recoilKey:"relock_modal",atomKey:"stake_relockModal_period",placeHolder:"1 Weeks",style:$?{}:{marginLeft:"auto"},maxValue:ye,isError:me,errorMsg:ve.stakePeriodExceed,isDisabled:!1,leftDays:ue,leftTime:se,endTime:me?void 0:ie})]})]}),(0,l.jsx)(f.k,{px:$?"30px":"43px",mb:"30px",children:(0,l.jsx)(E.default,{pageKey:"Stake_screen",periodKey:"stake_relockModal_period",subKey:"relock_modal",isSlideDisabled:!1})}),(0,l.jsx)(V.default,{addTos:U})]}),(0,l.jsx)(f.k,{justifyContent:"center",mb:"21px",children:oe?(0,l.jsx)(v.Z,{w:$?310:460,h:42,name:"Update",isDisabled:xe,onClick:Oe}):(0,l.jsx)(v.Z,{w:$?310:460,h:42,name:"Approve",onClick:Te,isDisabled:he||be||me})})]})})})]})}},19400:function(e,t,n){n.r(t),n.d(t,{default:function(){return y}});var r=n(85893),o=n(67294),l=n(45093),a=n(93717),i=n(54968),c=n(46850),u=n(83077),s=n(60938),d=n(74506),f=n(31617);var p=function(e){var t,n=(0,s.Z)("Stake_screen","relock_modal").inputValue,r=(0,f.Z)(e),l=(r.newEndTime,r.inputTosAmount,r.tosValue),a=r.allLtosToTosBalance,i=e&&a?Number(null===n||void 0===n||null===(t=n.stake_relockModal_tos_balance)||void 0===t?void 0:t.replaceAll(",",""))+a:Number(l.replaceAll(",","")),p=(0,d.Z)(0,n.stake_relockModal_period),k=p.leftDays,b=p.leftHourAndMin,m=Number(n.stake_relockModal_period),x=(0,o.useMemo)((function(){if(void 0!==k&&void 0!==b&&void 0!==m)return(86400*Number(k)+3600*Number(b.split(":")[0])+60*Number(b.split(":")[1]))/604800+m}),[k,b,m]),h=(0,c.Z)().rebasePerEpoch,v=((0,u.O)().blockTimeStamp,(0,o.useMemo)((function(){if(void 0!==x)return Math.floor(21*x)}),[x])),y=(0,o.useMemo)((function(){if(void 0!==i&&h&&v)return i*Math.pow(1+h,v)}),[i,h,v]);return{newBalanceStos:(0,o.useMemo)((function(){if(void 0!==y&&void 0!==x)return y*x/156}),[y,x])}},k=n(27520),b=n(68506),m=n(4480);function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,l=[],a=!0,i=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(l.push(r.value),!t||l.length!==t);a=!0);}catch(c){i=!0,o=c}finally{try{a||null==n.return||n.return()}finally{if(i)throw o}}return l}}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return x(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return x(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var y=function(e){var t,n=e.addTos,c=(0,k.Z)().bp700px,u=(0,s.Z)("Stake_screen","relock_modal"),d=u.inputValue,x=(u.setResetValue,u.setValue,(0,f.Z)(n)),y=x.newEndTime,S=x.tosValue,_=x.tosBalance,g=x.allLtosBalance,O=(x.allLtosToTosBalance,p(n).newBalanceStos),T=v((0,m.FV)(i.ws),2),j=(T[0],T[1],(0,m.sJ)(i.lW),[{title:"You Give",content:"".concat(null!==(t=(0,l.Z)(d.stake_relockModal_ltos_balance))&&void 0!==t?t:"-"," LTOS"),secondContent:n?"".concat(d.stake_relockModal_tos_balance," TOS"):void 0,tooltip:"Amount of LTOS and TOS used for staking.",secondTooltip:"Currently worth ".concat(S||"-"," TOS. As LTOS index increases, the number of TOS you can get from unstaking LTOS will also increase.")},{title:"You Will Get",content:"".concat(n?g:(0,l.Z)(d.stake_relockModal_ltos_balance)," LTOS"),secondContent:"".concat((0,l.Z)(O)," sTOS"),thirdContent:n?void 0:"".concat(_," TOS"),tooltip:"Amount of LTOS, sTOS, and TOS you will get after the update. ",secondTooltip:"Currently worth ".concat(S," TOS. As LTOS index increases, the number of TOS you can get from unstaking LTOS will also increase."),thirdTooltip:"sTOS\u2019s lock-up period is calculated relative to Thursday 00:00 (UTC+0).",fourthTooltip:n?void 0:"Any LTOS that does not get relocked is returned to you in TOS."},{title:"New End Time",content:y,tooltip:"LTOS can be unstaked after this time."}]);return(0,r.jsx)(a.k,{flexDir:"column",columnGap:"9px",mb:"30px",px:c?"20px":"50px",children:j.map((function(e){return(0,o.createElement)(b.default,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){h(e,t,n[t])}))}return e}({},e,{key:e.title}))}))})}}}]);