(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9393],{76491:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/components/stake/UpdateModal",function(){return n(96100)}])},27541:function(e,t,n){"use strict";var r=n(85893),o=n(48940),i=n(45161),a=n(93717),c=n(82140),u=n(33090),l=n(71293),s=n(32735),f=n(14225),d=n(60938),p=n(27520),v=n(67294);function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){m(e,t,n[t])}))}return e}t.Z=function(e){e.placeHolder;var t=e.w,n=e.h,h=e.isDisabled,g=e.atomKey,x=e.isError,y=e.style,k=e.pageKey,S=e.recoilKey,j=e.maxValue,P=e.errorMsg,w=(e.rightUnit,e.minValue,e.leftDays),N=e.leftTime,O=e.isDisabledText,T=e.endTime,_=e.isManageModal,Z=((0,o.F)(),(0,i.If)().colorMode),M=(0,v.useState)("Weeks"),C=M[0],I=M[1],A=(0,v.useState)(!1),D=A[0],E=A[1],z=(0,v.useState)(!1),W=(z[0],z[1],(0,p.Z)().bp700px),B=(0,d.Z)(k,S),V=B.inputValue,$=B.value,R=B.setValue,K=(0,v.useMemo)((function(){return $&&g&&$[g]?$[g]<10?"27px":$[g]&&$[g]<100?"37px":"42px":"27px"}),[$,g]);return(0,r.jsxs)(a.k,b({flexDir:"column",pos:"relative"},y,{children:[(0,r.jsxs)(c.B,{children:[(0,r.jsx)(u.I,{isInvalid:x,isDisabled:h,w:t||270,h:n||45,ml:"auto",borderRadius:8,borderWidth:1,borderColor:"light"===Z?"#e8edf2":"#313442",fontSize:14,color:!1===D?"#64646f":"light"===Z?"gray.800":h?"#64646f":"#f1f1f1",_placeholder:{color:"#64646f"},_hover:{borderColor:"light"===Z?"#c6cbd9":"#535353"},focusBorderColor:"none",_focus:x?{}:{outline:"none",color:"light"===Z?"gray.800":"#f1f1f1",boxShadow:"",borderColor:"light"===Z?"#9a9aaf":"#8a8a98"},outline:"none",errorBorderColor:h?"none":"#e23738",value:"".concat(h?O||"-":$[g]),onChange:function(e){if(!isNaN(e.target.value)&&!e.target.value.includes(".")&&!e.target.value.includes(" "))return 0===Number(e.target.value)&&(console.log("-1-"),I("Weeks"),E(!1)),Number(e.target.value)>1&&(console.log("-2-"),I("Weeks"),E(!0)),1===Number(e.target.value)&&(console.log("-3-"),I("Week"),E(!0)),R(b({},V,m({},g,e.target.value)))}}),(0,r.jsx)(a.k,{pos:"absolute",left:K,textAlign:"center",lineHeight:"39px",fontSize:14,children:(!1===h||!0===_)&&w&&N&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.x,{color:!1===D?"#64646f":"light"===Z?"gray.800":h?"#64646f":"#f1f1f1",children:C}),(0,r.jsxs)(l.x,{fontSize:12,ml:"9px",mr:"3px",color:D?"dark"===Z?"#8b8b93":"#7e7e8f":"",children:[w," ",1===Number(w)?"Day":"Days"," ",N]})]})}),(0,r.jsx)(s.x,{mr:"8px",display:"flex",alignItems:"center",children:(0,r.jsx)(f.z,{w:"30px",h:"20px",color:"dark"===Z?"#64646f":"#7e7e8f",_hover:{color:"#2775ff"},bg:"none",fontSize:14,fontWeight:600,isDisabled:h,onClick:function(){V[g]!==j&&j&&R(b({},V,m({},g,j)))},children:"Max"})})]}),x&&!1===h&&(0,r.jsx)(a.k,{w:"100%",fontSize:12,color:"#e23738",pos:"absolute",mt:"40px",textAlign:"right",justifyContent:"center",children:(0,r.jsx)(l.x,{children:P})}),T&&(0,r.jsx)(a.k,{pos:"absolute",top:"48px",w:t||270,justifyContent:W?"flex-start":"center",children:(0,r.jsxs)(l.x,{children:["End Time : ",T]})})]}))}},35418:function(e,t,n){"use strict";n.d(t,{$:function(){return u},K:function(){return c}});var r=n(68806);function o(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}function i(){var e=o(["\n  query GetDashboard($period: String!, $limit: Int!) {\n    getDashboard(period: $period, limit: $limit) {\n      _id\n      chainId\n      createdAt\n      marketCap\n      runway\n      tosPrice\n      tosSupply\n      sTosSupply\n      lTosSupply\n      totalValueStaked\n      treasuryBalance\n      updatedAt\n    }\n  }\n"]);return i=function(){return e},e}function a(){var e=o(["\n  query GetDashboardCard($period: String!, $limit: Int!) {\n    getDashboardCard(period: $period, limit: $limit) {\n      tosPrice\n      backingPerTos\n      ltosPrice\n      mintingRate\n      ltosIndex\n      chainId\n    }\n  }\n"]);return a=function(){return e},e}var c=(0,r.Ps)(i()),u=(0,r.Ps)(a())},66028:function(e,t,n){"use strict";function r(){var e,t,n=(e=["\n  query GetTokenPrice($tokenId: String!) {\n    getTokenPrice(tokenId: $tokenId) {\n      price\n    }\n  }\n"],t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}})));return r=function(){return n},n}n.d(t,{N:function(){return o}});var o=(0,n(68806).Ps)(r())},81271:function(e,t,n){"use strict";var r=n(34051),o=n.n(r),i=n(37243),a=n(67294),c=n(35418),u=n(76312),l=n(45093),s=n(68462),f=n(79102),d=n(77044),p=n(35553),v=n(2593),m=n(50266),b=n(88586);function h(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(l){return void n(l)}c.done?t(u):Promise.resolve(u).then(r,o)}function g(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){h(i,r,o,a,c,"next",e)}function c(e){h(i,r,o,a,c,"throw",e)}a(void 0)}))}}t.Z=function(){var e=(0,i.Z)().selectedModalData,t=(0,a.useState)(void 0),n=t[0],r=t[1],h=(0,a.useState)(void 0),x=(h[0],h[1],(0,u.aM)(c.K,{variables:{period:"-1",limit:1},pollInterval:1e4})),y=(x.loading,x.error,x.data),k=(0,s.Z)(),S=k.BondDepositoryProxy_CONTRACT,j=k.StakingV2Proxy_CONTRACT,P=(0,d.Ge)(),w=(0,m.Z)().priceData,N=(b.Z.mainnetGasPrice,b.Z.minBondGasPrice);return(0,a.useEffect)((function(){function t(){return(t=g(o().mark((function t(){var n,i,a,c,u,s,d,m,b,h,g,x,k,O,T;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!(e&&y&&w&&S)){t.next=28;break}return t.next=4,S.viewMarket(e.index);case 4:return i=t.sent,t.next=7,null===S||void 0===S?void 0:S.purchasableAssetAmountAtOneTime(i.tosPrice,i.maxPayout);case 7:return a=t.sent,t.next=10,null===j||void 0===j?void 0:j.possibleIndex();case 10:return c=t.sent,t.next=13,S.getBonds();case 13:return u=t.sent,t.next=16,null===(n=P.library)||void 0===n?void 0:n.getGasPrice();case 16:s=t.sent,Number(p.bM(s,9)),d=(0,f.WN)({amount:null===a||void 0===a?void 0:a.toString()}),m=(0,f.WN)({amount:null===c||void 0===c?void 0:c.toString()}),b=u[4],h=1/Number(b.toString())*1e18*w.ethPrice,g=(0,l.Z)(y.getDashboard[0].tosPrice),x=Number(g)-Number(e.bondingPrice)/(100*Number(g)),k=Number(e.discountRate.replaceAll("%",""))/100,O=v.O$.from((0,f.Az)(N)).mul(s).div((0,f.Az)(k.toString())),T=(0,f.WN)({amount:O.toString(),decimalPoints:6,decimalPlaces:6}),r({bondPrice:"$".concat((0,l.Z)(h)),marketPrice:"$".concat(g),discount:"".concat((0,l.Z)(x),"%"),minBond:"".concat(Number(T)<0?"0.000000":T),maxBond:"".concat((0,l.Z)(d)),ltosIndex:"".concat((0,l.Z)(m))});case 28:case"end":return t.stop()}}),t)})))).apply(this,arguments)}try{!function(){t.apply(this,arguments)}()}catch(n){console.log("**useBondModal err**"),console.log(n)}}),[e,y,S,j,null===P||void 0===P?void 0:P.library,w,N]),{bondModalData:n}}},5371:function(e,t,n){"use strict";var r=n(34051),o=n.n(r),i=n(45093),a=n(79102),c=n(5555),u=n(32082),l=n(5835),s=n(89406),f=n(68462),d=n(60938),p=n(37243),v=n(67294),m=n(74506);function b(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(l){return void n(l)}c.done?t(u):Promise.resolve(u).then(r,o)}function h(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){b(i,r,o,a,c,"next",e)}function c(e){b(i,r,o,a,c,"throw",e)}a(void 0)}))}}t.Z=function(){var e,t=(0,v.useState)("-"),n=t[0],r=t[1],b=(0,v.useState)("-"),g=b[0],x=b[1],y=(0,v.useState)(1),k=y[0],S=y[1],j=(0,v.useState)("-"),P=j[0],w=j[1],N=(0,v.useState)("-"),O=N[0],T=N[1],_=(0,f.Z)(),Z=_.StakingV2Proxy_CONTRACT,M=(_.LockTOS_CONTRACT,(0,s.Z)()),C=M.stakeId,I=(M.connectId,(0,l.Z)()),A=((0,p.Z)().selectedModalData,(0,d.Z)("Stake_screen","update_modal").inputValue),D=Number(null===I||void 0===I||null===(e=I.currentTosAmount)||void 0===e?void 0:e.replaceAll(",",""))+Number(A.stake_updateModal_tos_balance),E=(0,m.Z)(D,Number(A.stake_updateModal_period)),z=E.stosReward,W=E.newEndTime,B=(0,u.Z)().epochUnit;return(0,v.useEffect)((function(){function e(){return(e=h(o().mark((function e(){var t,n,r,i,a,u,l,s,f,d,p;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Z&&C&&I&&(t=I.currentEndTime,n=I.currentEndTimeStamp,x("".concat(t," (").concat((0,c.Ze)(),")")),r=(0,c.kv)(),a=(i=n-r)/B,u=(i-604800*Math.floor(a))/86400,l=i-604800*Math.floor(a)-86400*Math.floor(u),s=(0,c.g9)(l,"HH:mm").hours,f=(0,c.g9)(l,"HH:mm").mins,d=1===s.toString().length?"0".concat(s):"".concat(s),p=1===f.toString().length?"0".concat(f):"".concat(f),S(Math.floor(a)),w(String(Math.floor(u))),T("".concat(d,":").concat(p)));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(function(){return e.apply(this,arguments)})().catch((function(e){}))}),[C,Z,I,B]),(0,v.useEffect)((function(){function e(){return(e=h(o().mark((function e(){var t,n,c,u;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Z||!(null===I||void 0===I?void 0:I.ltosBalance)||void 0===A.stake_updateModal_tos_balance){e.next=8;break}return t=(0,a.Az)(A.stake_updateModal_tos_balance.replaceAll(",","")),e.next=4,Z.getTosToLtosPossibleIndex(t);case 4:n=e.sent,c=(0,a.WN)({amount:n}),u=Number(null===I||void 0===I?void 0:I.ltosBalance.replaceAll(",",""))+Number(null===c||void 0===c?void 0:c.replaceAll(",","")),r((0,i.Z)(u));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(function(){return e.apply(this,arguments)})().catch((function(e){console.log("**useUpdateModalData2 err**"),console.log(e)}))}),[Z,A,I]),{currentEndTime:g,newEndTime:W,leftWeeks:k,leftDays:P,leftTime:O,newStosBalance:z,newLtosBalance:n,totalTosAmount:D}}},50266:function(e,t,n){"use strict";var r=n(76312),o=n(35418),i=n(66028),a=n(67294);t.Z=function(){var e=(0,a.useState)(void 0),t=e[0],n=e[1],c=(0,r.aM)(o.K,{variables:{period:"-1",limit:1}}),u=(c.loading,c.error,c.data),l=(0,r.aM)(i.N,{variables:{tokenId:"ethereum"}}).data;return(0,a.useEffect)((function(){if(u&&l){var e,t=(null===(e=u.getDashboard[0])||void 0===e?void 0:e.tosPrice)||"0",r=l.getTokenPrice.price;n({tosPrice:Number(t),ethPrice:Number(r)})}}),[u,l]),{priceData:t}}},43382:function(e,t,n){"use strict";var r=n(34051),o=n.n(r),i=n(79102),a=n(77044),c=n(67294),u=n(28450),l=n(83077),s=n(68462);function f(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(l){return void n(l)}c.done?t(u):Promise.resolve(u).then(r,o)}function d(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){f(i,r,o,a,c,"next",e)}function c(e){f(i,r,o,a,c,"throw",e)}a(void 0)}))}}t.Z=function(){var e=(0,c.useState)({tosAllowance:void 0,stakeList:void 0,simpleStakingId:void 0}),t=e[0],n=e[1],r=(0,s.Z)().TOS_CONTRACT,f=(0,a.Ge)().account,p=u.Z.StakingV2Proxy,v=(0,l.O)().blockNumber,m=(0,s.Z)().StakingV2Proxy_CONTRACT;return(0,c.useEffect)((function(){function e(){return(e=d(o().mark((function e(){var t,a,c;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(r&&f&&m)){e.next=9;break}return e.next=4,r.allowance(f,p);case 4:return a=e.sent,e.next=7,m.stakingOf(f);case 7:return c=e.sent,e.abrupt("return",n({tosAllowance:Number((0,i.WN)({amount:a.toString()})),stakeList:c,simpleStakingId:null===(t=c[1])||void 0===t?void 0:t.toString()}));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}(function(){return e.apply(this,arguments)})().then((function(e){void 0!==e&&(console.log("**fetchUseUser err**"),console.log(e))}))}),[r,f,p,v,m]),t}},60316:function(e,t,n){"use strict";n.r(t);var r=n(85893),o=n(45161),i=n(93717),a=n(85129),c=n(38658),u=n(88586),l=n(60938),s=n(67294);function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){f(e,t,n[t])}))}return e}t.default=function(e){var t=e.pageKey,n=e.subKey,p=e.periodKey,v=e.balanceKey,m=e.isSlideDisabled,b=e.minValue,h={mt:"2",ml:"-2.5",fontSize:"sm"},g=(0,l.Z)(t,n),x=g.inputValue,y=(g.value,g.setValue),k=(0,s.useState)(0),S=k[0],j=k[1],P=(0,s.useState)(!1),w=P[0],N=(P[1],(0,o.If)().colorMode),O=(0,s.useState)(!1),T=O[0],_=O[1];return(0,s.useEffect)((function(){0!==S&&_(!0)}),[S]),(0,s.useEffect)((function(){var e;if(v&&T&&(""===x[v]||void 0===x[v]))return y(d({},x,(f(e={},v,0),f(e,p,S),e)));return y(d({},x,f({},p,S)))}),[S,p,v,T]),(0,s.useEffect)((function(){if(x[p])return j(Number(x[p]))}),[x,p]),(0,s.useEffect)((function(){return j(m?0:u.Z.modalMaxWeeks)}),[m]),(0,r.jsx)(i.k,{w:"100%",h:"70px",pos:"relative",children:(0,r.jsxs)(a.iR,{focusThumbOnChange:!1,"aria-label":"slider-ex-1",defaultValue:0,min:0,max:u.Z.modalMaxWeeks,value:S,onChange:function(e){return j(b&&b>e?b:e)},h:"10px",alignSelf:"end",isDisabled:m,children:[(0,r.jsx)(a.jz,d({value:0},h,{children:"7d"})),(0,r.jsx)(a.jz,d({value:52},h,{children:"1y"})),(0,r.jsx)(a.jz,d({value:104},h,{children:"2y"})),(0,r.jsx)(a.jz,d({value:155},h,{children:"3y"})),(0,r.jsxs)(a.Uj,{bg:"light"===N?"#e7edf3":"#353d48",children:[(0,r.jsx)(a.Ms,{bg:"#2775ff"}),b&&(0,r.jsx)(a.Ms,{maxW:"".concat(b/155*100,"%"),bg:"#2bb415"})]}),(0,r.jsx)(c.u,{color:"light"===N?"#07070c":"#f1f1f1",placement:"top",bg:"transparent",w:"50px",display:"flex",alignItems:"center",justifyContent:"center",textAlign:"center",fontSize:"15px",fontWeight:600,isOpen:w,label:"".concat(S," sTOS"),children:(0,r.jsx)(a.gs,{})})]})})}},33090:function(e,t,n){"use strict";n.d(t,{I:function(){return s}});var r=n(28912),o=n(16554),i=n(77030),a=n(33179),c=n(22548),u=n(25432),l=n(85893),s=(0,o.G)((function(e,t){const{htmlSize:n,...o}=e,s=(0,i.jC)("Input",o),f=(0,a.Lr)(o),d=(0,r.Y)(f),p=(0,u.cx)("chakra-input",e.className);return(0,l.jsx)(c.m.input,{size:n,...d,__css:s.field,ref:t,className:p})}));s.displayName="Input",s.id="Input"}},function(e){e.O(0,[4885,2678,8658,8555,246,7277,3942,7756,6100,9774,2888,179],(function(){return t=76491,e(e.s=t);var t}));var t=e.O();_N_E=t}]);